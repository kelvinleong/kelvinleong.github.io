<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"><![endif]-->
<!--[if IE 7]><html class="no-js lt-ie9 lt-ie8" <![endif]-->
<!--[if IE 8]><html class="no-js lt-ie9" <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->


<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <title>Auto Login Bank Account using Python</title>

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/assets/img/favicon.ico" />

    <!-- Come and get me RSS readers -->
    <link rel="alternate" type="application/rss+xml" title="Kelvin" href="127.0.0.1/feed.xml" />
    
    <!-- Stylesheet -->
    <link rel="stylesheet" href="/assets/css/style.css">
    <!--[if IE 8]><link rel="stylesheet" href="/assets/css/ie.css"><![endif]-->
    <link rel="canonical" href="127.0.0.1/python/2016/07/19/Scrape-Bank-Account.html">

    <!-- Modernizr -->
    <script src="/assets/js/modernizr.custom.15390.js" type="text/javascript"></script>

     <!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
<script>
   (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-78047723-1', 'auto');
ga('send', 'pageview');

</script>
 

    
</head>


<body>

    <div class="header">
     <div class="container">
         <h1 class="logo"><a href="/">Kelvin</a></h1>
         <nav class="nav-collapse">
             <ul class="noList">
                 
                 <li class="element first  ">
                     <a href="/index.html">Home</a>
                 </li> 
                 
                 <li class="element   ">
                     <a href="/about.html">About</a>
                 </li> 
                 
                 <li class="element   last">
                     <a href="/contact.html">Contact</a>
                 </li> 
                 
                 <li> <a href="https://github.com/brianmaierjr/long-haul" target="_blank">GitHub</a></li>
                 <li><a href="https://github.com/brianmaierjr/long-haul/archive/master.zip">Download Theme</a></li>
             </ul>
         </nav>
     </div>
 </div><!-- end .header -->


   <div class="content">
      <div class="sidebar">
        <div class="widget-wrapper">
<h3 class="widget-title">Archive</h3>
<ul>

    
    
        <li><a href="/archive.html#August2016">August 2016</a></li>
        
    

    
    
        <li><a href="/archive.html#July2016">July 2016</a></li>
        
    

    
    
        <li><a href="/archive.html#June2016">June 2016</a></li>
        
    

    
    

    
    
        <li><a href="/archive.html#May2016">May 2016</a></li>
        
    

    
    

    
    
        <li><a href="/archive.html#March2016">March 2016</a></li>
        
    

    
    
        <li><a href="/archive.html#December2015">December 2015</a></li>
        
    

    
    
        <li><a href="/archive.html#November2015">November 2015</a></li>
        
    

    
    

    
    

    
    
        <li><a href="/archive.html#October2015">October 2015</a></li>
        
    

    
    
        <li><a href="/archive.html#September2015">September 2015</a></li>
        
    

    
    

    
    
        <li><a href="/archive.html#August2015">August 2015</a></li>
        
    

    
    

    
    

    
    

    
    

</ul>
</div>

<div class="widget-wrapper">
<h3 class="widget-title">Categories</h3>
<ul>
  
    
     <li><a href="/categories.html#Theme-ref">
     Theme</span>
     </a></li>
    
     <li><a href="/categories.html#Database-ref">
     Database</span>
     </a></li>
    
     <li><a href="/categories.html#Java-ref">
     Java</span>
     </a></li>
    
     <li><a href="/categories.html#Encoding-ref">
     Encoding</span>
     </a></li>
    
     <li><a href="/categories.html#PDF-ref">
     PDF</span>
     </a></li>
    
     <li><a href="/categories.html#JVM-ref">
     JVM</span>
     </a></li>
    
     <li><a href="/categories.html#Oracle-ref">
     Oracle</span>
     </a></li>
    
     <li><a href="/categories.html#Multithreading-ref">
     Multithreading</span>
     </a></li>
    
     <li><a href="/categories.html#Google-ref">
     Google</span>
     </a></li>
    
     <li><a href="/categories.html#Python-ref">
     Python</span>
     </a></li>
    
  
</ul>
</div>

      </div>
      <div class="container">
          <div class="post">
  
  <h1 class="postTitle">Auto Login Bank Account using Python</h1>
  <p class="meta">July 19, 2016 | <span class="time">5</span> Minute Read</p>

  <p>Whenever I want to check my HSBC bank account, it requires me to input the first password and some random bits of the second password. However, I always mistakenly fill the wrong password which results that I have to input the information again which is tedious. And what’s serious is that if you input incorrect passwords for more than 3 times then your account will be locked until you unblock it via the passcode authentication. Therefore, I want to automate the login process so that I don’t have to deal with.</p>

<p>After google, I found the most convenient way to implement should be using python with Selenium libraray. So in this tutorial, I will use python and selenium to implement and following packages are all I need.</p>

<blockquote>
  <p>Selenium (See the <a href="http://selenium-python.readthedocs.io/installation.html">installation guide and introduction of Selenium</a>)</p>
</blockquote>

<p>o let’s begin our tour to auto login the HSBC e-banking account.</p>

<p>We will perform the following steps to auto login the website:</p>

<ul>
  <li>Extract and study the details in the webpage that we need for the login</li>
  <li>Perform login to site</li>
</ul>

<h3 id="step-1-study-the-website">Step 1. Study the website</h3>

<p>To login my HSBC e-banking account, it requires me fill the username first and end up in another page to input the first password and some bits of your second password i.e., 2-way authentication.</p>

<p><img src="/resources/Autologin/username-page.png" alt="Alt text" /></p>

<h4 id="check-the-details-that-we-need-to-extract-in-order-to-login">Check the details that we need to extract in order to login</h4>

<p>In the first login page, we have to fill the username and click “Dual Password” to proceed.</p>

<p><img src="/resources/Autologin/usrname-page-html.png" alt="Alt text" /></p>

<p>With the help of browser safari (chrome is more recommended), we can inspect the page source so that to analyze the site. By right click the user name field and select “inspect element” we can find this input which the value of the “name” attribute is “u_UserID”. Therefore I can fill the input field with my account name using selenium <strong><em>send_Keys</em></strong> api. Apply the same principle, find the element “Dual Password” and perform the click action via its native method “Click”. Note, some times we may get multiple elements by just one criteria and by default selenium will just return the first element to us. Therefore we can consider to use “find_element_by_xpath” which could guarantee the uniqueness.</p>

<p>Code implementation:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c"># find username input</span>
<span class="n">usr_name_input</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s">"u_UserID"</span><span class="p">)</span>
<span class="n">usr_name_input</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s">"your_user_name"</span><span class="p">)</span>

<span class="c"># submit the form (although google automatically searches now without submitting)</span>
<span class="n">submit</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s">"//a[@href='javascript:PC_7_0G3UNU10SD0MHTI7TQA0000000000000_validate()']"</span><span class="p">)</span>
<span class="n">submit</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</code></pre>
</div>

<p>Now that we should reach the page which requires us to fill the password.</p>

<p><img src="/resources/Autologin/fill-pwd.png" alt="Alt text" /></p>

<p>For the first password, by “find_element_by_xpath” method we can get the control of the element and use send_keys api to fill the password. For the second password, the key solution is to find out the index so that we can get the field by traversing the array and fill it to the element. Having observed the second password I found the trick that some fields are omitted represented by 3 dots so that the index after will be denoted by “xxxlast” (xxx is the reversed index) or “Last” (if the first last).</p>

<p>Code implementation:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c"># now we are on the password input page and fill the first password</span>
<span class="n">firstPassword</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s">"memorableAnswer"</span><span class="p">)</span>
<span class="n">firstPassword</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s">"your_first_password"</span><span class="p">)</span>

<span class="c"># find the index</span>
<span class="n">all_secondPassword</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">all_secondPassword</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_elements_by_xpath</span><span class="p">(</span><span class="s">"//td[@width='28']"</span><span class="p">)</span>

<span class="n">valid_sec_pwd</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">secondPwd</span> <span class="ow">in</span> <span class="n">all_secondPassword</span><span class="p">:</span>
    <span class="n">sec_pwd_input</span> <span class="o">=</span> <span class="n">secondPwd</span><span class="o">.</span><span class="n">find_elements_by_xpath</span><span class="p">(</span><span class="s">".//label[@for='code']"</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sec_pwd_input</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">index_str</span> <span class="o">=</span> <span class="n">sec_pwd_input</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"index_str: "</span> <span class="o">+</span> <span class="n">index_str</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">index_str</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">):</span>
            <span class="k">if</span> <span class="s">'last'</span> <span class="ow">in</span> <span class="n">index_str</span> <span class="ow">or</span> <span class="s">'Last'</span> <span class="ow">in</span> <span class="n">index_str</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">index_str</span> <span class="o">==</span> <span class="s">'Last'</span><span class="p">):</span>
                    <span class="n">index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sec_pwd</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sec_pwd</span><span class="p">)</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">index_str</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">index_str</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">valid_sec_pwd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sec_pwd</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
            <span class="k">print</span><span class="p">(</span><span class="n">valid_sec_pwd</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Not required field"</span><span class="p">)</span>

<span class="c"># fill the second password</span>
<span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">j</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">:</span>
    <span class="n">sec_pwd_name</span> <span class="o">=</span> <span class="s">'RCC_PWD'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">field</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="n">sec_pwd_name</span><span class="p">)</span>
    <span class="n">field</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">valid_sec_pwd</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
    <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre>
</div>

<h3 id="step-2-perform-the-logon-action">Step 2. Perform the logon action</h3>

<p>Well, it is almost done as we have filled all the required information! The last step is to click the “Logon” button and if successfully authenticated, we should see the bank account page.</p>

<p>Code implementation:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c"># press logon</span>

<span class="n">logon</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s">"//input[@src='/P2GTheme/themes/html/BDE_HBAP_LOGON/images/buttons/btn_logon_png.gif']"</span><span class="p">)</span>
<span class="n">logon</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</code></pre>
</div>

<p>So far, we can automate the login process without inputing username or password  which may save you from the login pain.</p>

<p>For the integrated codes please find in the <a href="https://github.com/kelvinleong/hsbc_bank_account_autologin">repo</a>.</p>


  <!-- POST NAVIGATION -->
  <div class="postNav clearfix">
    
      <a class="prev" href="/google/2016/06/20/GA-analytics.html"><span>&laquo;&nbsp;Use Google Analytic to monitor website</span>
      
    </a>
    
    
      <a class="next" href="/python/2016/08/19/Download-Secure-Data.html"><span>Download Secure Data with Request&nbsp;&raquo;</span>
      
      </a>
    
  </div>
</div>

      </div>
   </div><!-- end .content -->

   <div class="footer">
   <div class="container">
      <p class="copy">&copy; 2016 <a href="">Kelvin Liang</a> Powered by <a href="http://jekyllrb.com">Jekyll</a></p>

      <div class="footer-links">
         <ul class="noList">
            
            <li><a href="https://www.facebook.com/kelvin.Y.H.Leung">
                  <svg id="facebook-square" class="custom-icon" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 100" style="height: 30px; width: 30px;"><circle class="outer-shape" cx="50" cy="50" r="48" style="opacity: 1;"></circle>
                  <path class="inner-shape" style="opacity: 1;" transform="translate(25,25) scale(0.5)" d="M82.667,1H17.335C8.351,1,1,8.351,1,17.336v65.329c0,8.99,7.351,16.335,16.334,16.335h65.332 C91.652,99.001,99,91.655,99,82.665V17.337C99,8.353,91.652,1.001,82.667,1L82.667,1z M84.318,50H68.375v42.875H50V50h-8.855V35.973 H50v-9.11c0-12.378,5.339-19.739,19.894-19.739h16.772V22.3H72.967c-4.066-0.007-4.57,2.12-4.57,6.078l-0.023,7.594H86.75 l-2.431,14.027V50z"></path>
                  </svg>
            </a></li>
            
            
            
            <li><a href="https://github.com/kelvinleong">
                  <svg id="github" class="custom-icon" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 100" style="height: 30px; width: 30px;"><circle class="outer-shape" cx="50" cy="50" r="48" style="opacity: 1;"></circle>
                  <path class="inner-shape" style="opacity: 1;" transform="translate(25,25) scale(0.5)" d="M50,1C22.938,1,1,22.938,1,50s21.938,49,49,49s49-21.938,49-49S77.062,1,50,1z M79.099,79.099 c-3.782,3.782-8.184,6.75-13.083,8.823c-1.245,0.526-2.509,0.989-3.79,1.387v-7.344c0-3.86-1.324-6.699-3.972-8.517 c1.659-0.16,3.182-0.383,4.57-0.67c1.388-0.287,2.855-0.702,4.402-1.245c1.547-0.543,2.935-1.189,4.163-1.938 c1.228-0.75,2.409-1.723,3.541-2.919s2.082-2.552,2.847-4.067s1.372-3.334,1.818-5.455c0.446-2.121,0.67-4.458,0.67-7.01 c0-4.945-1.611-9.155-4.833-12.633c1.467-3.828,1.308-7.991-0.478-12.489l-1.197-0.143c-0.829-0.096-2.321,0.255-4.474,1.053 c-2.153,0.798-4.57,2.105-7.249,3.924c-3.797-1.053-7.736-1.579-11.82-1.579c-4.115,0-8.039,0.526-11.772,1.579 c-1.69-1.149-3.294-2.097-4.809-2.847c-1.515-0.75-2.727-1.26-3.637-1.532c-0.909-0.271-1.754-0.439-2.536-0.503 c-0.782-0.064-1.284-0.079-1.507-0.048c-0.223,0.031-0.383,0.064-0.478,0.096c-1.787,4.53-1.946,8.694-0.478,12.489 c-3.222,3.477-4.833,7.688-4.833,12.633c0,2.552,0.223,4.889,0.67,7.01c0.447,2.121,1.053,3.94,1.818,5.455 c0.765,1.515,1.715,2.871,2.847,4.067s2.313,2.169,3.541,2.919c1.228,0.751,2.616,1.396,4.163,1.938 c1.547,0.543,3.014,0.957,4.402,1.245c1.388,0.287,2.911,0.511,4.57,0.67c-2.616,1.787-3.924,4.626-3.924,8.517v7.487 c-1.445-0.43-2.869-0.938-4.268-1.53c-4.899-2.073-9.301-5.041-13.083-8.823c-3.782-3.782-6.75-8.184-8.823-13.083 C9.934,60.948,8.847,55.56,8.847,50s1.087-10.948,3.231-16.016c2.073-4.899,5.041-9.301,8.823-13.083s8.184-6.75,13.083-8.823 C39.052,9.934,44.44,8.847,50,8.847s10.948,1.087,16.016,3.231c4.9,2.073,9.301,5.041,13.083,8.823 c3.782,3.782,6.75,8.184,8.823,13.083c2.143,5.069,3.23,10.457,3.23,16.016s-1.087,10.948-3.231,16.016 C85.848,70.915,82.88,75.317,79.099,79.099L79.099,79.099z"></path>
                  </svg>
            </a></li>
            
            
         </ul>
      </div>
   </div>
</div><!-- end .footer -->

   <!-- Add jQuery and other scripts -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src=""><\/script>')</script>
<script src="/assets/js/dropcap.min.js"></script>
<script src="/assets/js/responsive-nav.min.js"></script>
<script src="/assets/js/scripts.js"></script>
<link rel="stylesheet" href="/assets/js/plugins/prettify.css">
<script src="/assets/js/plugins/prettify.js"></script>
<script type="text/javascript">
  $(function(){
    $("pre").addClass("prettyprint");
    prettyPrint();
  });
</script>


</body>

</html>
